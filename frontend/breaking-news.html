<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Breaking News & Live Updates - Global News Network</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        
    </style>
</head>
<body>
    <!-- Top Bar with Date and Social Links -->
    <div class="top-bar">
        <div class="container top-bar-content">
            <div class="date-time">
                <span id="current-date"></span>
                <span id="current-time"></span>
            </div>
            <div class="social-icons">
                <a href="#"><i class="fab fa-facebook-f"></i></a>
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
                <a href="#"><i class="fab fa-youtube"></i></a>
                <a href="#"><i class="fab fa-linkedin-in"></i></a>
            </div>
        </div>
    </div>

    <div id="navbar-placeholder"></div>

    <!-- Breaking News Header -->
    <div class="breaking-header">
        <div class="container">
            <div class="live-indicator">
                <div class="live-dot"></div>
                <span>LIVE UPDATES</span>
            </div>
            <h1 class="breaking-title">Breaking News</h1>
            <p class="breaking-subtitle">Real-time updates on developing stories from around the world</p>
            <div class="breaking-stats">
                <div class="breaking-stat-item">
                    <span class="breaking-stat-number" id="active-stories">47</span>
                    <span class="breaking-stat-label">Active Stories</span>
                </div>
                <div class="breaking-stat-item">
                    <span class="breaking-stat-number" id="updates-today">312</span>
                    <span class="breaking-stat-label">Updates Today</span>
                </div>
                <div class="breaking-stat-item">
                    <span class="breaking-stat-number" id="live-sources">28</span>
                    <span class="breaking-stat-label">Live Sources</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container main-content">
        <!-- Left Column - Live Feed -->
        <div class="left-column">
            <!-- Breaking News Alert -->
            <div class="breaking-alert">
                <div class="alert-header">
                    <div class="alert-icon">
                        <i class="fas fa-bullhorn"></i>
                    </div>
                    <h3 class="alert-title">MAJOR EARTHQUAKE HITS COASTAL REGION</h3>
                </div>
                <div class="alert-content">
                    A 7.2 magnitude earthquake has struck the coastal region, triggering tsunami warnings. Emergency services are responding. Casualty reports are still coming in. Stay tuned for updates.
                </div>
                <div class="alert-actions">
                    <button class="alert-btn primary" id="followStoryBtn">
                        <i class="fas fa-bell"></i> Follow This Story
                    </button>
                    <button class="alert-btn" id="safetyInfoBtn">
                        <i class="fas fa-info-circle"></i> Safety Information
                    </button>
                </div>
            </div>

            <!-- Live Feed -->
            <div class="live-feed-container">
                <div class="live-feed-header">
                    <h2><i class="fas fa-broadcast-tower"></i> Live News Feed</h2>
                    <button class="refresh-btn" id="refreshFeedBtn">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                </div>
                <div class="live-feed" id="liveFeed">
                    <!-- Feed items will be added here by JavaScript -->
                </div>
            </div>

            <!-- Map Section -->
            <div class="map-section">
                <h3><i class="fas fa-map-marked-alt"></i> Breaking News Map</h3>
                <div class="map-placeholder">
                    <i class="fas fa-globe-americas"></i>
                    <span>Live Breaking News Map</span>
                    <small>Showing real-time incident locations</small>
                </div>
                <div class="map-legend">
                    <div class="legend-item">
                        <div class="legend-color legend-breaking"></div>
                        <span>Breaking News</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color legend-alert"></div>
                        <span>Alert / Warning</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color legend-update"></div>
                        <span>Recent Update</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Column - Sidebar -->
        <div class="right-column">
            <!-- Top Breaking Stories -->
            <div class="sidebar-section">
                <h3 class="sidebar-title">TOP BREAKING STORIES</h3>
                <div class="top-breaking-item">
                    <div class="top-breaking-number">01</div>
                    <div class="top-breaking-content">
                        <h4>Major Earthquake Hits Coastal Region, Tsunami Warning Issued</h4>
                        <div class="top-breaking-category">DISASTER</div>
                    </div>
                </div>
                <div class="top-breaking-item">
                    <div class="top-breaking-number">02</div>
                    <div class="top-breaking-content">
                        <h4>Political Crisis Deepens as Government Faces No-Confidence Vote</h4>
                        <div class="top-breaking-category">POLITICS</div>
                    </div>
                </div>
                <div class="top-breaking-item">
                    <div class="top-breaking-number">03</div>
                    <div class="top-breaking-content">
                        <h4>Stock Markets Plunge Amid Economic Uncertainty</h4>
                        <div class="top-breaking-category">BUSINESS</div>
                    </div>
                </div>
                <div class="top-breaking-item">
                    <div class="top-breaking-number">04</div>
                    <div class="top-breaking-content">
                        <h4>Cyberattack Cripples Major Government Systems</h4>
                        <div class="top-breaking-category">TECHNOLOGY</div>
                    </div>
                </div>
                <div class="top-breaking-item">
                    <div class="top-breaking-number">05</div>
                    <div class="top-breaking-content">
                        <h4>Major Transportation Hub Shut Down Due to Security Threat</h4>
                        <div class="top-breaking-category">SECURITY</div>
                    </div>
                </div>
            </div>

            <!-- Developing Stories -->
            <div class="sidebar-section developing-stories">
                <h3 class="sidebar-title">DEVELOPING STORIES</h3>
                <div class="developing-story">
                    <div class="developing-badge">DEVELOPING</div>
                    <div class="developing-content">
                        <h4>Rescue Operations Underway After Earthquake</h4>
                        <div class="developing-time">Updated 15 min ago</div>
                    </div>
                </div>
                <div class="developing-story">
                    <div class="developing-badge">DEVELOPING</div>
                    <div class="developing-content">
                        <h4>International Response to Political Crisis</h4>
                        <div class="developing-time">Updated 25 min ago</div>
                    </div>
                </div>
                <div class="developing-story">
                    <div class="developing-badge">DEVELOPING</div>
                    <div class="developing-content">
                        <h4>Markets Continue Volatile Trading</h4>
                        <div class="developing-time">Updated 40 min ago</div>
                    </div>
                </div>
                <div class="developing-story">
                    <div class="developing-badge">DEVELOPING</div>
                    <div class="developing-content">
                        <h4>Investigation Into Cyberattack Origins</h4>
                        <div class="developing-time">Updated 1 hour ago</div>
                    </div>
                </div>
            </div>

            <!-- Emergency Information -->
            <div class="sidebar-section">
                <div class="emergency-info">
                    <h3><i class="fas fa-first-aid"></i> EMERGENCY INFORMATION</h3>
                    <ul class="emergency-list">
                        <li>Tsunami Warning: Move to higher ground immediately</li>
                        <li>Emergency Hotline: 1-800-555-HELP</li>
                        <li>Local Shelters: Check with local authorities</li>
                        <li>Power Outages: Report to utility companies</li>
                        <li>Road Closures: Avoid affected areas</li>
                    </ul>
                </div>
            </div>

            <!-- Advertisement -->
            <div class="sidebar-section">
                <div class="ad-banner" style="height: 250px;">
                    Advertisement<br>300x250
                </div>
            </div>
        </div>
    </div>

    <!-- Live Updates Banner -->
    <div class="live-updates-banner" id="liveUpdatesBanner">
        <div class="container banner-content">
            <div class="banner-text">
                <div class="new-updates">NEW UPDATES</div>
                <div id="bannerMessage">New breaking news updates available</div>
            </div>
            <div class="banner-actions">
                <button class="banner-btn" id="dismissBannerBtn">Dismiss</button>
                <button class="banner-btn primary" id="loadUpdatesBtn">
                    <i class="fas fa-sync-alt"></i> Load Updates
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Global News Network</h3>
                    <p>Delivering accurate, timely, and comprehensive news coverage from around the world since 1995.</p>
                    <div class="social-icons" style="margin-top: 20px;">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="contact.html">Contact Us</a></li>
                        <li><a href="careers.html">Careers</a></li>
                        <li><a href="privacy.html">Privacy Policy</a></li>
                        <li><a href="terms.html">Terms of Service</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Alert Services</h3>
                    <ul class="footer-links">
                        <li><a href="#">Breaking News Alerts</a></li>
                        <li><a href="#">Emergency Notifications</a></li>
                        <li><a href="#">Weather Alerts</a></li>
                        <li><a href="#">Traffic Updates</a></li>
                        <li><a href="#">Security Advisories</a></li>
                        <li><a href="#">Health Alerts</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Contact Info</h3>
                    <ul class="footer-links">
                        <li><i class="fas fa-map-marker-alt"></i> 123 News Street, Media City, MC 10001</li>
                        <li><i class="fas fa-phone"></i> +1 (555) 123-4567</li>
                        <li><i class="fas fa-envelope"></i> info@globalnewsnetwork.com</li>
                        <li><i class="fas fa-clock"></i> 24/7 Breaking News Desk</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="copyright">
            <div class="container">
                &copy; 2023 Global News Network. All rights reserved. | Breaking News updates 24/7
            </div>
        </div>
    </footer>

    <script type="module">
        import { initComponents } from '/assets/js/app.js';
        import { fetchBreakingNews } from '/assets/js/api-adapter.js';

        document.addEventListener('DOMContentLoaded', async () => {
            await initComponents();

            const liveFeedEl = document.getElementById('liveFeed');
            const activeStoriesEl = document.getElementById('active-stories');
            const updatesTodayEl = document.getElementById('updates-today');
            const liveSourcesEl = document.getElementById('live-sources');

            const bannerMessage = document.getElementById('bannerMessage');
            const liveUpdatesBanner = document.getElementById('liveUpdatesBanner');

            try {
                Components.showLoadingState('liveFeed');
                const feed = await fetchBreakingNews();

                const items = (feed || []).map((f) => ({
                    time: new Date(f.date || f.time || Date.now()).toLocaleTimeString(),
                    category: (f.category_slug || f.category || '').toUpperCase(),
                    title: f.title,
                    content: f.excerpt || f.content || '',
                    source: f.source || f.author || 'Source',
                    type: f.type || (f.is_breaking ? 'breaking' : 'update'),
                    id: f.id
                }));

                // Render live feed items
                if (liveFeedEl) {
                    liveFeedEl.innerHTML = items
                        .map((it) => `
                            <div class="feed-item ${it.type}">
                                <div class="feed-time">${it.time}</div>
                                <div class="feed-content">
                                    <a href="/news-detail.html?id=${it.id}"><h4>${it.title}</h4></a>
                                    <div class="feed-meta">${it.category} â€¢ ${it.source}</div>
                                    <p>${it.content}</p>
                                </div>
                            </div>
                        `)
                        .join('');
                }

                // Update quick stats
                if (activeStoriesEl) activeStoriesEl.textContent = items.length;
                if (updatesTodayEl) updatesTodayEl.textContent = items.length * 3; // mock: assume multiple updates
                if (liveSourcesEl) liveSourcesEl.textContent = new Set(items.map((i) => i.source)).size;

                // Use Components to render breaking ticker in header if desired
                // insert before main content if not present (id 'breaking-placeholder' on index page)
                // For this page we simply populate the banner message
                if (bannerMessage) bannerMessage.textContent = items.length ? `${items.length} live updates available` : 'No new updates';

                // wire refresh button
                const refreshBtn = document.getElementById('refreshFeedBtn');
                if (refreshBtn) {
                    refreshBtn.addEventListener('click', async () => {
                        refreshBtn.disabled = true;
                        refreshBtn.textContent = 'Refreshing...';
                        try {
                            const newFeed = await fetchBreakingNews();
                            const newCount = (newFeed || []).length;
                            if (bannerMessage) bannerMessage.textContent = `${newCount} live updates available`;
                            if (liveFeedEl) liveFeedEl.insertAdjacentHTML('afterbegin', '<div class="feed-refresh">Feed refreshed</div>');
                        } catch (e) {
                            console.error('refresh failed', e);
                        } finally {
                            refreshBtn.disabled = false;
                            refreshBtn.textContent = 'Refresh';
                        }
                    });
                }

                // banner actions
                const loadUpdatesBtn = document.getElementById('loadUpdatesBtn');
                if (loadUpdatesBtn) {
                    loadUpdatesBtn.addEventListener('click', () => {
                        if (liveUpdatesBanner) liveUpdatesBanner.style.display = 'none';
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    });
                }

                const dismissBanner = document.getElementById('dismissBannerBtn');
                if (dismissBanner) dismissBanner.addEventListener('click', () => {
                    if (liveUpdatesBanner) liveUpdatesBanner.style.display = 'none';
                });

            } catch (err) {
                console.error('Failed to load breaking feed', err);
                Components.showErrorState('liveFeed', 'Failed to load live feed');
            }
        });
    </script>
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            dateElement.textContent = now.toLocaleDateString('en-US', options);
            timeElement.textContent = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
        }
        
        // Update date/time immediately and then every minute
        updateDateTime();
        setInterval(updateDateTime, 60000);
        
        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const navLinks = document.querySelector('.nav-links');
        
        mobileMenuBtn.addEventListener('click', () => {
            navLinks.classList.toggle('active');
        });
        
        // Initialize live feed
        function renderLiveFeed() {
            const liveFeed = document.getElementById('liveFeed');
            liveFeed.innerHTML = '';
            
            breakingNewsFeed.forEach(item => {
                const feedItem = document.createElement('div');
                feedItem.className = `feed-item ${item.type}`;
                
                feedItem.innerHTML = `
                    <div class="feed-time">
                        <i class="far fa-clock"></i>
                        <span>${item.time} | LIVE</span>
                    </div>
                    <div class="feed-category">${item.category}</div>
                    <h4 class="feed-title">${item.title}</h4>
                    <div class="feed-content">${item.content}</div>
                    <div class="feed-meta">
                        <div class="feed-source">Source: ${item.source}</div>
                        <div>
                            <a href="#" class="comment-action">Follow</a> | 
                            <a href="#" class="comment-action">Share</a>
                        </div>
                    </div>
                `;
                
                liveFeed.appendChild(feedItem);
            });
        }
        
        // Initial render
        renderLiveFeed();
        
        // Refresh feed functionality
        const refreshFeedBtn = document.getElementById('refreshFeedBtn');
        refreshFeedBtn.addEventListener('click', function() {
            // Add spinning animation
            this.classList.add('spinning');
            
            // Simulate API call delay
            setTimeout(() => {
                // Remove spinning animation
                this.classList.remove('spinning');
                
                // Add a new feed item at the top
                const newUpdateTime = new Date();
                const timeString = `${newUpdateTime.getHours()}:${newUpdateTime.getMinutes().toString().padStart(2, '0')}`;
                
                const newUpdates = [
                    {
                        time: timeString,
                        category: "UPDATE",
                        title: "Rescue teams report successful extraction of 15 people from collapsed building",
                        content: "Latest reports indicate successful rescue operations with more teams arriving on scene.",
                        source: "Rescue Command",
                        type: "update"
                    },
                    {
                        time: timeString,
                        category: "ECONOMY",
                        title: "Government announces emergency economic stimulus package",
                        content: "New measures aim to support businesses and individuals affected by recent events.",
                        source: "Treasury Dept",
                        type: "update"
                    }
                ];
                
                // Add new updates to beginning of array
                breakingNewsFeed.unshift(...newUpdates);
                
                // Keep only latest 12 items
                if (breakingNewsFeed.length > 12) {
                    breakingNewsFeed.length = 12;
                }
                
                // Update counters
                document.getElementById('updates-today').textContent = 
                    parseInt(document.getElementById('updates-today').textContent) + newUpdates.length;
                
                // Re-render feed
                renderLiveFeed();
                
                // Show banner notification
                showBannerNotification(`${newUpdates.length} new updates available`);
                
                alert(`Feed refreshed! Added ${newUpdates.length} new updates.`);
            }, 1500);
        });
        
        // Follow story button
        const followStoryBtn = document.getElementById('followStoryBtn');
        followStoryBtn.addEventListener('click', function() {
            const isFollowing = this.classList.contains('following');
            
            if (!isFollowing) {
                this.innerHTML = '<i class="fas fa-bell-slash"></i> Unfollow Story';
                this.classList.add('following');
                alert('You are now following this breaking news story. You will receive alerts for major updates.');
            } else {
                this.innerHTML = '<i class="fas fa-bell"></i> Follow This Story';
                this.classList.remove('following');
                alert('You have unfollowed this story.');
            }
        });
        
        // Safety info button
        const safetyInfoBtn = document.getElementById('safetyInfoBtn');
        safetyInfoBtn.addEventListener('click', function() {
            alert('SAFETY INFORMATION:\n\n1. During earthquakes: Drop, Cover, and Hold On\n2. If near coast and tsunami warning: Move to higher ground immediately\n3. Have emergency supplies ready\n4. Follow official instructions from authorities\n5. Check on neighbors, especially elderly or disabled');
        });
        
        // Live updates banner
        const liveUpdatesBanner = document.getElementById('liveUpdatesBanner');
        const bannerMessage = document.getElementById('bannerMessage');
        const dismissBannerBtn = document.getElementById('dismissBannerBtn');
        const loadUpdatesBtn = document.getElementById('loadUpdatesBtn');
        
        function showBannerNotification(message) {
            bannerMessage.textContent = message;
            liveUpdatesBanner.classList.add('show');
            
            // Auto-hide after 30 seconds
            setTimeout(() => {
                liveUpdatesBanner.classList.remove('show');
            }, 30000);
        }
        
        dismissBannerBtn.addEventListener('click', () => {
            liveUpdatesBanner.classList.remove('show');
        });
        
        loadUpdatesBtn.addEventListener('click', () => {
            refreshFeedBtn.click();
            liveUpdatesBanner.classList.remove('show');
        });
        
        // Simulate new updates arriving periodically
        let updateCount = 0;
        function simulateNewUpdates() {
            updateCount++;
            
            if (updateCount % 3 === 0) {
                const newUpdateTime = new Date();
                const timeString = `${newUpdateTime.getHours()}:${newUpdateTime.getMinutes().toString().padStart(2, '0')}`;
                
                const simulatedUpdates = [
                    {
                        time: timeString,
                        category: "DEVELOPING",
                        title: "New developments in ongoing political negotiations",
                        content: "Sources indicate progress in high-level talks aimed at resolving current political crisis.",
                        source: "Political Insider",
                        type: "update"
                    },
                    {
                        time: timeString,
                        category: "RESCUE",
                        title: "Additional international aid arriving in affected region",
                        content: "More countries pledging support. Relief supplies being distributed to evacuation centers.",
                        source: "Humanitarian Desk",
                        type: "update"
                    }
                ];
                
                // Show banner notification
                showBannerNotification(`${simulatedUpdates.length} new updates available`);
                
                // Add to feed
                breakingNewsFeed.unshift(...simulatedUpdates);
                
                // Keep only latest 12 items
                if (breakingNewsFeed.length > 12) {
                    breakingNewsFeed.length = 12;
                }
                
                // Update counters
                document.getElementById('updates-today').textContent = 
                    parseInt(document.getElementById('updates-today').textContent) + simulatedUpdates.length;
                document.getElementById('active-stories').textContent = 
                    parseInt(document.getElementById('active-stories').textContent) + 1;
            }
            
            // Schedule next update (between 2-5 minutes)
            const nextUpdateTime = 120000 + Math.random() * 180000; // 2-5 minutes
            setTimeout(simulateNewUpdates, nextUpdateTime);
        }
        
        // Start simulated updates after initial load
        setTimeout(simulateNewUpdates, 60000); // Start after 1 minute
        
        // Auto-refresh feed every 5 minutes
        setInterval(() => {
            // Only auto-refresh if user hasn't manually refreshed in last minute
            refreshFeedBtn.click();
        }, 300000); // 5 minutes
        
        // Feed item click functionality
        document.addEventListener('click', function(e) {
            if (e.target.closest('.feed-item')) {
                const feedItem = e.target.closest('.feed-item');
                const title = feedItem.querySelector('.feed-title').textContent;
                alert(`Opening detailed update: "${title}"\nIn a full implementation, this would show detailed information about this breaking news update.`);
            }
            
            if (e.target.closest('.top-breaking-item') || e.target.closest('.developing-story')) {
                const item = e.target.closest('.top-breaking-item') || e.target.closest('.developing-story');
                const title = item.querySelector('h4').textContent;
                alert(`Opening breaking story: "${title}"\nThis would navigate to a detailed article about this breaking news story.`);
            }
        });
        
        // Search functionality
        const searchInput = document.querySelector('.search-bar input');
        const searchButton = document.querySelector('.search-bar button');
        
        searchButton.addEventListener('click', () => {
            const query = searchInput.value.trim();
            if (query) {
                alert(`Searching breaking news for: "${query}"\nThis would filter the live feed to show only relevant updates.`);
                searchInput.value = '';
            }
        });
        
        // Emergency list item click
        const emergencyItems = document.querySelectorAll('.emergency-list li');
        emergencyItems.forEach(item => {
            item.addEventListener('click', () => {
                const infoText = item.textContent;
                alert(`Emergency Information: ${infoText}\nThis would provide detailed instructions or contact information.`);
            });
        });
        
        // Initialize with banner after page loads
        setTimeout(() => {
            showBannerNotification('Live breaking news feed is active. Updates every 2-5 minutes.');
        }, 3000);
    </script>
</body>
</html>