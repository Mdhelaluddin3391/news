<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trending News - Most Popular Stories | Global News Network</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/trending.css">
    <link rel="stylesheet" href="/assets/css/global.css">
</head>
<body>
    <!-- Top Bar with Date and Social Links -->
    <div class="top-bar">
        <div class="container top-bar-content">
            <div class="date-time">
                <span id="current-date"></span>
                <span id="current-time"></span>
            </div>
            <div class="social-icons">
                <a href="#"><i class="fab fa-facebook-f"></i></a>
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
                <a href="#"><i class="fab fa-youtube"></i></a>
                <a href="#"><i class="fab fa-linkedin-in"></i></a>
            </div>
        </div>
    </div>

    <div id="navbar-placeholder"></div>

    <!-- Trending Header -->
    <div class="trending-header">
        <div class="container">
            <div class="trending-badge">
                <i class="fas fa-fire"></i> TRENDING NOW
            </div>
            <h1>What's Trending Worldwide</h1>
            <p>Discover the most popular, shared, and talked-about stories from across the globe. Updated in real-time based on views, shares, and engagement.</p>
            
            <div class="trending-tabs">
                <button class="trending-tab active" data-tab="all">All Trending</button>
                <button class="trending-tab" data-tab="viral">Viral Stories</button>
                <button class="trending-tab" data-tab="popular">Most Popular</button>
                <button class="trending-tab" data-tab="rising">Rising Fast</button>
                <button class="trending-tab" data-tab="today">Today</button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container main-content">
        <!-- Left Column - Main Content -->
        <div class="left-column">
            <!-- Time Filter -->
            <div class="time-filter">
                <h3>Trending Period</h3>
                <div class="filter-options">
                    <button class="filter-btn active" data-period="today">Today</button>
                    <button class="filter-btn" data-period="week">This Week</button>
                    <button class="filter-btn" data-period="month">This Month</button>
                    <button class="filter-btn" data-period="year">This Year</button>
                    <button class="filter-btn" data-period="all">All Time</button>
                </div>
            </div>

            <!-- Trending Grid -->
            <div class="trending-grid" id="trendingGrid">
                <!-- Trending cards will be populated by JavaScript -->
            </div>

            <!-- Most Shared List -->
            <div class="trending-list-section">
                <div class="section-header">
                    <h2><i class="fas fa-share-alt"></i> Most Shared Stories</h2>
                    <a href="#" class="view-all">View All <i class="fas fa-chevron-right"></i></a>
                </div>
                <ul class="trending-list" id="sharedList">
                    <!-- Shared list items will be populated by JavaScript -->
                </ul>
            </div>

            <!-- Trending Chart -->
            <div class="trending-chart">
                <div class="chart-header">
                    <h3>Trending Engagement Analytics</h3>
                    <div class="chart-legend">
                        <div class="legend-item">
                            <div class="legend-color legend-views"></div>
                            <span>Views</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color legend-shares"></div>
                            <span>Shares</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color legend-comments"></div>
                            <span>Comments</span>
                        </div>
                    </div>
                </div>
                <div class="chart-placeholder">
                    <i class="fas fa-chart-line"></i>
                    <span>Trending Engagement Chart</span>
                    <small>Visualization of trending article performance over time</small>
                </div>
            </div>

            <!-- Most Commented List -->
            <div class="trending-list-section">
                <div class="section-header">
                    <h2><i class="fas fa-comments"></i> Most Discussed Stories</h2>
                    <a href="#" class="view-all">View All <i class="fas fa-chevron-right"></i></a>
                </div>
                <ul class="trending-list" id="commentedList">
                    <!-- Commented list items will be populated by JavaScript -->
                </ul>
            </div>
        </div>

        <!-- Right Column - Sidebar -->
        <div class="right-column">
            <!-- Viral Moments -->
            <div class="sidebar-section">
                <div class="viral-moment">
                    <h3><i class="fas fa-bolt"></i> VIRAL MOMENTS</h3>
                    <div class="viral-item">
                        <div class="viral-icon">
                            <i class="fab fa-twitter"></i>
                        </div>
                        <div class="viral-content">
                            <h4>AI President Meme Goes Viral</h4>
                            <div class="viral-platform">Twitter • 2.4M mentions</div>
                        </div>
                    </div>
                    <div class="viral-item">
                        <div class="viral-icon">
                            <i class="fab fa-tiktok"></i>
                        </div>
                        <div class="viral-content">
                            <h4>Rescue Dog Video Trends Worldwide</h4>
                            <div class="viral-platform">TikTok • 15.7M views</div>
                        </div>
                    </div>
                    <div class="viral-item">
                        <div class="viral-icon">
                            <i class="fab fa-youtube"></i>
                        </div>
                        <div class="viral-content">
                            <h4>Scientists React to AI Breakthrough</h4>
                            <div class="viral-platform">YouTube • 8.3M views</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Trending Authors -->
            <div class="sidebar-section trending-authors">
                <h3 class="sidebar-title">TRENDING AUTHORS</h3>
                <div class="author-item">
                    <div class="author-avatar">SJ</div>
                    <div class="author-info">
                        <h4>Sarah Johnson</h4>
                        <div class="author-stats">3 trending stories • 2.4M views</div>
                    </div>
                </div>
                <div class="author-item">
                    <div class="author-avatar">MC</div>
                    <div class="author-info">
                        <h4>Michael Chen</h4>
                        <div class="author-stats">2 trending stories • 1.8M views</div>
                    </div>
                </div>
                <div class="author-item">
                    <div class="author-avatar">RP</div>
                    <div class="author-info">
                        <h4>Dr. Rebecca Park</h4>
                        <div class="author-stats">4 trending stories • 3.1M views</div>
                    </div>
                </div>
                <div class="author-item">
                    <div class="author-avatar">DW</div>
                    <div class="author-info">
                        <h4>David Wilson</h4>
                        <div class="author-stats">2 trending stories • 1.5M views</div>
                    </div>
                </div>
            </div>

            <!-- Trending Topics -->
            <div class="sidebar-section trending-topics">
                <h3 class="sidebar-title">TRENDING TOPICS</h3>
                <ul class="topic-list">
                    <li>
                        <a href="#" class="topic-item">
                            <span class="topic-name">Artificial Intelligence</span>
                            <span class="topic-count">142</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="topic-item">
                            <span class="topic-name">Climate Change</span>
                            <span class="topic-count">98</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="topic-item">
                            <span class="topic-name">Space Exploration</span>
                            <span class="topic-count">76</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="topic-item">
                            <span class="topic-name">Global Economy</span>
                            <span class="topic-count">64</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="topic-item">
                            <span class="topic-name">Health & Wellness</span>
                            <span class="topic-count">53</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="topic-item">
                            <span class="topic-name">Renewable Energy</span>
                            <span class="topic-count">47</span>
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Newsletter -->
            <div class="sidebar-section">
                <div class="newsletter-sidebar" style="background-color: var(--trending-color);">
                    <h3>Trending Alerts</h3>
                    <p>Get daily updates on the most trending stories delivered to your inbox.</p>
                    <form id="trendingNewsletterForm">
                        <input type="email" placeholder="Your email address" required>
                        <button type="submit" style="background-color: var(--secondary-color);">Subscribe Now</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Global News Network</h3>
                    <p>Delivering accurate, timely, and comprehensive news coverage from around the world since 1995.</p>
                    <div class="social-icons" style="margin-top: 20px;">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="contact.html">Contact Us</a></li>
                        <li><a href="careers.html">Careers</a></li>
                        <li><a href="privacy.html">Privacy Policy</a></li>
                        <li><a href="terms.html">Terms of Service</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Trending Categories</h3>
                    <ul class="footer-links">
                        <li><a href="#">Most Viewed</a></li>
                        <li><a href="#">Most Shared</a></li>
                        <li><a href="#">Most Commented</a></li>
                        <li><a href="#">Viral Stories</a></li>
                        <li><a href="#">Rising Stories</a></li>
                        <li><a href="#">Trending Topics</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Contact Info</h3>
                    <ul class="footer-links">
                        <li><i class="fas fa-map-marker-alt"></i> 123 News Street, Media City, MC 10001</li>
                        <li><i class="fas fa-phone"></i> +1 (555) 123-4567</li>
                        <li><i class="fas fa-envelope"></i> info@globalnewsnetwork.com</li>
                        <li><i class="fas fa-clock"></i> Mon-Fri: 9:00 AM - 6:00 PM</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="copyright">
            <div class="container">
                &copy; 2023 Global News Network. All rights reserved. | Tracking trending stories worldwide
            </div>
        </div>
    </footer>

    <script type="module">
        import { initComponents } from '/assets/js/app.js';
        import { fetchTrendingNews } from '/assets/js/api-adapter.js';

        document.addEventListener('DOMContentLoaded', async () => {
            await initComponents();

            const gridContainer = document.getElementById('trendingGrid');
            const sharedList = document.getElementById('sharedList');
            const commentedList = document.getElementById('commentedList');

            try {
                Components.showLoadingState('trendingGrid');
                const trending = await fetchTrendingNews();

                // Normalize mock articles to the shape Components expects
                const normalized = (trending || []).map((a) => ({
                    slug: a.id,
                    featured_image: a.image,
                    title: a.title,
                    excerpt: a.excerpt,
                    created_at: a.date,
                    views_count: a.views,
                    category: { name: (a.category_slug || '').toUpperCase() }
                }));

                if (gridContainer) {
                    gridContainer.innerHTML = normalized.length
                        ? Components.renderNewsGrid(normalized)
                        : '<p>No trending articles at the moment.</p>';
                }

                // Populate Most Shared and Most Commented using views as fallback
                const byViews = (trending || []).slice().sort((x, y) => (y.views || 0) - (x.views || 0));
                const topShared = byViews.slice(0, 5);
                if (sharedList) {
                    sharedList.innerHTML = topShared
                        .map((it, i) => `
                            <li class="list-item">
                                <div class="list-rank">${String(i + 1).padStart(2, '0')}</div>
                                <div class="list-content">
                                    <a href="/news-detail.html?id=${it.id}"><h4 class="list-title">${it.title}</h4></a>
                                    <div class="list-meta"><span>${(it.category_slug || '').toUpperCase()}</span><span>${new Date(it.date).toLocaleString()}</span></div>
                                </div>
                                <div class="list-stats"><div class="stat-item"><i class="fas fa-share-alt"></i><span>${it.views} shares</span></div></div>
                            </li>
                        `)
                        .join('');
                }

                // For commented list use same ordering (mock doesn't include comments)
                if (commentedList) {
                    commentedList.innerHTML = topShared
                        .map((it, i) => `
                            <li class="list-item">
                                <div class="list-rank">${String(i + 1).padStart(2, '0')}</div>
                                <div class="list-content">
                                    <a href="/news-detail.html?id=${it.id}"><h4 class="list-title">${it.title}</h4></a>
                                    <div class="list-meta"><span>${(it.category_slug || '').toUpperCase()}</span><span>${new Date(it.date).toLocaleString()}</span></div>
                                </div>
                                <div class="list-stats"><div class="stat-item"><i class="far fa-comment"></i><span>— comments</span></div></div>
                            </li>
                        `)
                        .join('');
                }

                // Wire simple tab behavior (filters are visual; re-render same data)
                document.querySelectorAll('.trending-tab').forEach((tab) => {
                    tab.addEventListener('click', (e) => {
                        document.querySelectorAll('.trending-tab').forEach((t) => t.classList.remove('active'));
                        tab.classList.add('active');
                        // re-render same dataset for now; backend later will provide category
                        if (gridContainer) gridContainer.innerHTML = Components.renderNewsGrid(normalized);
                    });
                });

            } catch (err) {
                console.error('Failed to load trending data', err);
                Components.showErrorState('trendingGrid', 'Failed to load trending data');
            }
        });
    </script>
</body>
</html>